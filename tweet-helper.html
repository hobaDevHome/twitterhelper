<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <title>Tweet Launcher (am / pm)</title>
    <style>
      body {
        font-family: sans-serif;
        direction: rtl;
        padding: 20px;
      }
      select,
      button {
        font-size: 18px;
        margin-top: 10px;
      }
      #status {
        margin-top: 15px;
      }
    </style>
  </head>
  <body>
    <h2>ğŸ“‚ Ø§Ø®ØªØ± Ø§Ù„Ù…Ù„Ù: AM Ø£Ùˆ PM</h2>

    <select id="fileSelector" onchange="loadFile()">
      <option value="">-- Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„Ø¯Ø¹ÙˆØ§Øª --</option>
      <option value="am.csv">am.csv</option>
      <option value="pm.csv">pm.csv</option>
    </select>

    <br />
    <button onclick="sendNext()" disabled id="nextBtn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
    <p id="status"></p>

    <script>
      let invites = [];
      let index = 0;

      function loadFile() {
        const filename = document.getElementById("fileSelector").value;
        if (!filename) return;

        fetch(filename)
          .then((response) => {
            if (!response.ok) throw new Error("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù");
            return response.text();
          })
          .then((text) => {
            invites = text.split(/\r?\n/).filter((line) => line.trim() !== "");
            index = 0;
            document.getElementById("nextBtn").disabled = false;
            document.getElementById(
              "status"
            ).textContent = `ğŸ“„ ØªÙ… ØªØ­Ù…ÙŠÙ„ ${invites.length} Ø¯Ø¹ÙˆØ© Ù…Ù† "${filename}"`;
          })
          .catch((err) => {
            console.error(err);
            document.getElementById("status").textContent =
              "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù";
          });
      }

      function sendNext() {
        if (index < invites.length) {
          const text = encodeURIComponent(invites[index++]);
          const tweetURL = `https://twitter.com/intent/tweet?text=${text}`;
          window.open(tweetURL, "_blank");
          document.getElementById(
            "status"
          ).textContent = `âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯Ø¹ÙˆØ© Ø±Ù‚Ù… ${index} Ù…Ù† ${invites.length}`;
        } else {
          alert("ğŸ‰ Ø®Ù„ØµÙ†Ø§ ÙƒÙ„ Ø§Ù„Ø¯Ø¹ÙˆØ§Øª!");
        }
      }
    </script>
  </body>
</html>
